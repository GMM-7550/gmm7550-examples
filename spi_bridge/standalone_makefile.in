# Autogenerated Makefile for standalone example project for GMM-7550 module
# Example name: @NAME@
# Exported on : @DATE@
# git commit  : @GIT_COMMIT@

# This file is a part of the GMM-7550 VHDL Examples
# <https://github.com/ak-fau/gmm7550-examples.git>
#
# SPDX-License-Identifier: MIT
#
# Copyright (c) 2023 Anton Kuzmin <anton.kuzmin@cs.fau.de>

TOP := @NAME@

VHDL_SRC := $(wildcard src/*.vhd)

DIRS := east west north

.PHONY: all synth impl libs manifest
.PHONY: $(DIRS)

all: impl

TOPDIR := $(shell pwd)
COMMONDIR := $(TOPDIR)/common
export TOPDIR
export COMMONDIR

CC_LIB_NAME   := cc
VHDL_STANDARD := 08
export CC_LIB_NAME
export VHDL_STANDARD

include $(COMMONDIR)/defs.mk

CC_LIB_DIR := $(TOPDIR)/$(CC_LIB_NAME)
CC_LIB := $(CC_LIB_DIR)/$(SYNTHDIR)/$(CC_LIB_NAME)-obj$(VHDL_STANDARD).cf

CC_TOOLCHAIN := $(TOPDIR)/../../../cc-toolchain

CCF := $(IMPLDIR)/$(TOP).ccf

include $(COMMONDIR)/flow.mk

synth: $(NETLIST)

$(NETLIST): $(VHDL_SRC) $(CC_LIB) | $(SYNTHDIR) $(LOGDIR)
	$(call run_synthesis)

libs: $(LIBS)

$(CC_LIB):
	$(MAKE) -C $(CC_LIB_DIR)

PINOUT := $(COMMONDIR)/mem-io.lua

impl: synth $(DIRS)

LOCAL_MAKEFILE := $(TOP).mk
include $(COMMONDIR)/$(LOCAL_MAKEFILE)
include $(SYNTHDIR)/dirs.mk

.PHONE: clean_configs

clean_configs:
	$(RM) -r $(CFGDIR)

distclean: clean_configs
